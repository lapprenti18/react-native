{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nvar _this = this,\n    _jsxFileName = \"/home/lapprenti18/sandbox/react-native/src/components/LoadAssets.tsx\";\n\nimport React, { useCallback, useEffect, useState } from \"react\";\nimport { AsyncStorage } from \"react-native-web/dist/index\";\nimport { AppLoading } from \"expo\";\nimport { Asset } from \"expo-asset\";\nimport * as Font from \"expo-font\";\nimport { NavigationContainer } from \"@react-navigation/native\";\nimport Constants from \"expo-constants\";\nvar NAVIGATION_STATE_KEY = \"NAVIGATION_STATE_KEY-\" + Constants.manifest.sdkVersion;\n\nvar usePromiseAll = function usePromiseAll(promises, cb) {\n  return useEffect(function () {\n    (function _callee() {\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(Promise.all(promises));\n\n            case 2:\n              cb();\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    })();\n  });\n};\n\nvar useLoadAssets = function useLoadAssets(assets, fonts) {\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      ready = _useState2[0],\n      setReady = _useState2[1];\n\n  usePromiseAll([Font.loadAsync(fonts)].concat(_toConsumableArray(assets.map(function (asset) {\n    return Asset.loadAsync(asset);\n  }))), function () {\n    return setReady(true);\n  });\n  return ready;\n};\n\nvar LoadAssets = function LoadAssets(_ref) {\n  var assets = _ref.assets,\n      fonts = _ref.fonts,\n      children = _ref.children;\n\n  var _useState3 = useState(!__DEV__),\n      _useState4 = _slicedToArray(_useState3, 2),\n      isNavigationReady = _useState4[0],\n      setIsNavigationReady = _useState4[1];\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      initialState = _useState6[0],\n      setInitialState = _useState6[1];\n\n  var ready = useLoadAssets(assets || [], fonts || {});\n  useEffect(function () {\n    var restoreState = function restoreState() {\n      var savedStateString, state;\n      return _regeneratorRuntime.async(function restoreState$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem(NAVIGATION_STATE_KEY));\n\n            case 3:\n              savedStateString = _context2.sent;\n              state = savedStateString ? JSON.parse(savedStateString) : undefined;\n              setInitialState(state);\n\n            case 6:\n              _context2.prev = 6;\n              setIsNavigationReady(true);\n              return _context2.finish(6);\n\n            case 9:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, [[0,, 6, 9]], Promise);\n    };\n\n    if (!isNavigationReady) {\n      restoreState();\n    }\n  }, [isNavigationReady]);\n  var onStateChange = useCallback(function (state) {\n    return AsyncStorage.setItem(NAVIGATION_STATE_KEY, JSON.stringify(state));\n  }, []);\n\n  if (!ready || !isNavigationReady) {\n    return React.createElement(AppLoading, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 12\n      }\n    });\n  }\n\n  return React.createElement(NavigationContainer, _extends({\n    onStateChange: onStateChange,\n    initialState: initialState\n  }, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 5\n    }\n  }), children);\n};\n\nexport default LoadAssets;","map":{"version":3,"sources":["/home/lapprenti18/sandbox/react-native/src/components/LoadAssets.tsx"],"names":["React","useCallback","useEffect","useState","AsyncStorage","AppLoading","Asset","Font","NavigationContainer","Constants","NAVIGATION_STATE_KEY","manifest","sdkVersion","usePromiseAll","promises","cb","Promise","all","useLoadAssets","assets","fonts","ready","setReady","loadAsync","map","asset","LoadAssets","children","__DEV__","isNavigationReady","setIsNavigationReady","initialState","setInitialState","restoreState","getItem","savedStateString","state","JSON","parse","undefined","onStateChange","setItem","stringify"],"mappings":"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","sourcesContent":["import React, { ReactElement, useCallback, useEffect, useState } from \"react\";\nimport { AsyncStorage } from \"react-native\";\nimport { AppLoading } from \"expo\";\nimport { Asset } from \"expo-asset\";\nimport * as Font from \"expo-font\";\nimport { InitialState, NavigationContainer } from \"@react-navigation/native\";\nimport Constants from \"expo-constants\";\n\nconst NAVIGATION_STATE_KEY = `NAVIGATION_STATE_KEY-${Constants.manifest.sdkVersion}`;\n\nexport type FontSource = Parameters<typeof Font.loadAsync>[0];\nconst usePromiseAll = (promises: Promise<void | void[]>[], cb: () => void) =>\n  useEffect(() => {\n    (async () => {\n      await Promise.all(promises);\n      cb();\n    })();\n  });\n\nconst useLoadAssets = (assets: number[], fonts: FontSource): boolean => {\n  const [ready, setReady] = useState(false);\n  usePromiseAll(\n    [Font.loadAsync(fonts), ...assets.map((asset) => Asset.loadAsync(asset))],\n    () => setReady(true)\n  );\n  return ready;\n};\n\ninterface LoadAssetsProps {\n  fonts?: FontSource;\n  assets?: number[];\n  children: ReactElement | ReactElement[];\n}\n\nconst LoadAssets = ({ assets, fonts, children }: LoadAssetsProps) => {\n  const [isNavigationReady, setIsNavigationReady] = useState(!__DEV__);\n  const [initialState, setInitialState] = useState<InitialState | undefined>();\n  const ready = useLoadAssets(assets || [], fonts || {});\n  useEffect(() => {\n    const restoreState = async () => {\n      try {\n        const savedStateString = await AsyncStorage.getItem(\n          NAVIGATION_STATE_KEY\n        );\n        const state = savedStateString\n          ? JSON.parse(savedStateString)\n          : undefined;\n        setInitialState(state);\n      } finally {\n        setIsNavigationReady(true);\n      }\n    };\n\n    if (!isNavigationReady) {\n      restoreState();\n    }\n  }, [isNavigationReady]);\n  const onStateChange = useCallback(\n    (state) =>\n      AsyncStorage.setItem(NAVIGATION_STATE_KEY, JSON.stringify(state)),\n    []\n  );\n  if (!ready || !isNavigationReady) {\n    return <AppLoading />;\n  }\n  return (\n    <NavigationContainer {...{ onStateChange, initialState }}>\n      {children}\n    </NavigationContainer>\n  );\n};\n\nexport default LoadAssets;"]},"metadata":{},"sourceType":"module"}